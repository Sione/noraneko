# タスク11 動作テスト手順書

## テスト環境
- ブラウザ: Chrome/Firefox/Safari 最新版
- 画面サイズ: デスクトップ(1920x1080), タブレット(768x1024), モバイル(375x667)

## 事前準備
1. アプリケーションを起動
2. ブラウザのデベロッパーツールを開く（F12）
3. Consoleタブでエラーがないことを確認

---

## テストケース

### TC1: 入力エラー対応（11.1）

#### TC1-1: 走者不在時の盗塁
**手順:**
1. 試合を開始
2. 走者が塁上にいない状態で攻撃指示画面を開く
3. 「盗塁」を選択

**期待結果:**
- ❌ エラーToastが表示される
- メッセージ: "盗塁を試みる走者がいません"
- 提案: "ランナーが塁上にいる時のみ盗塁できます"
- 指示は実行されない

#### TC1-2: ツーアウト時のバント
**手順:**
1. 試合を開始
2. ツーアウトの状態にする
3. 「バント」を選択

**期待結果:**
- ⚠️ 警告Toastが表示される
- メッセージ: "ツーアウトでのバントは推奨されません"
- 提案: "通常打撃で勝負するか、他の戦術を選択してください"
- 指示は実行される（警告のみ）

#### TC1-3: Toast通知の動作
**手順:**
1. エラーまたは警告を発生させる
2. Toast通知が表示されることを確認
3. 5秒待つ

**期待結果:**
- Toast通知がスライドインアニメーションで表示
- 5秒後に自動的に消える
- ×ボタンで手動で閉じることもできる

---

### TC2: システムエラーと自動保存（11.2）

#### TC2-1: 自動保存の動作
**手順:**
1. 試合を開始
2. 30秒以上プレイを続ける
3. ブラウザのコンソールを確認

**期待結果:**
- コンソールに「自動保存が完了しました」のログが表示される
- DevTools > Application > Local Storage に `baseball_auto_save` が保存される

#### TC2-2: エラーログの記録
**手順:**
1. DevTools > Console で以下を実行:
```javascript
throw new Error('Test error');
```

**期待結果:**
- ErrorBoundaryがエラーをキャッチ
- エラー画面が表示される
- Local Storage に `baseball_error_logs` が記録される

#### TC2-3: 試合再開ダイアログ
**手順:**
1. 試合中に自動保存される
2. ページをリロード（F5）

**期待結果:**
- 「試合を再開しますか？」ダイアログが表示される
- 保存日時が表示される（「たった今」「○分前」など）
- 「試合を再開」「新しい試合を開始」の2つのボタン

---

### TC3: 中断/再開フロー（11.3）

#### TC3-1: 一時停止メニュー
**手順:**
1. 試合中に⏸️ボタンをクリック
2. または ESCキーを押す

**期待結果:**
- 一時停止メニューが表示される
- 以下のオプションが表示される:
  - ▶️ 試合を再開
  - ⚙️ 設定
  - ❓ ヘルプ
  - 💾 保存して終了
  - 🚪 保存せずに終了

#### TC3-2: 保存して終了
**手順:**
1. 一時停止メニューを開く
2. 「保存して終了」をクリック

**期待結果:**
- 成功Toastが表示: "試合を保存しました"
- 1秒後にメインメニューに戻る
- Local Storageに保存データが残る

#### TC3-3: 保存せずに終了
**手順:**
1. 一時停止メニューを開く
2. 「保存せずに終了」をクリック

**期待結果:**
- 確認ダイアログが表示される
- "本当に終了しますか？この操作は取り消せません"
- 「キャンセル」と「保存せずに終了」ボタン

---

### TC4: 操作ガイドとヘルプ（11.4）

#### TC4-1: ヘルプモーダルの表示
**手順:**
1. ❓ヘルプボタンをクリック

**期待結果:**
- ヘルプモーダルが表示される
- 4つのタブが表示される:
  - 基本操作
  - 攻撃指示
  - 守備指示
  - 能力値

#### TC4-2: タブ切り替え
**手順:**
1. ヘルプモーダルを開く
2. 各タブをクリック

**期待結果:**
- タブがアクティブになる（青い下線）
- 対応するコンテンツが表示される
- スクロールが正常に動作する

#### TC4-3: 攻撃指示の説明
**手順:**
1. ヘルプモーダルを開く
2. 「攻撃指示」タブを選択

**期待結果:**
- 以下の指示の説明が表示される:
  - 通常打撃
  - バント
  - 盗塁
  - ダブルスチール
  - ヒットエンドラン
  - スクイズ
  - 待て
- 各指示に推奨条件、注意点、成功率が記載されている

---

### TC5: アクセシビリティとカスタマイズ（11.6）

#### TC5-1: 設定モーダルの表示
**手順:**
1. ⚙️設定ボタンをクリック

**期待結果:**
- 設定モーダルが表示される
- 以下のセクションが表示される:
  - 表示設定
  - ゲーム設定
  - テキスト表示
  - サウンド設定

#### TC5-2: テーマ変更
**手順:**
1. 設定モーダルを開く
2. テーマを「ダーク」に変更
3. 「保存」ボタンをクリック

**期待結果:**
- 「✓ 保存しました」メッセージが表示される
- ページ全体がダークテーマになる
- 設定がLocal Storageに保存される
- ページをリロードしても設定が保持される

#### TC5-3: 難易度設定
**手順:**
1. 設定モーダルを開く
2. 難易度を「初級（簡単）」に変更
3. 保存

**期待結果:**
- 設定が保存される
- CPUの戦術判断精度が変更される（次の試合から有効）

#### TC5-4: テキスト速度
**手順:**
1. 設定モーダルを開く
2. テキスト速度を0（即座に表示）に変更
3. 保存して試合に戻る

**期待結果:**
- 実況テキストが即座に全文表示される
- アニメーション効果がなくなる

#### TC5-5: 未保存変更の警告
**手順:**
1. 設定モーダルを開く
2. 何か設定を変更する
3. 保存せずに「キャンセル」または×をクリック

**期待結果:**
- 確認ダイアログが表示される
- "保存されていない変更があります。破棄して閉じますか？"
- OKで変更を破棄、キャンセルで設定画面に戻る

---

### TC6: レスポンシブ対応

#### TC6-1: モバイル表示
**手順:**
1. DevTools > Device Toolbar (Ctrl+Shift+M)
2. iPhone SE (375x667) を選択
3. 各モーダルを開く

**期待結果:**
- すべてのモーダルが全画面表示になる
- ボタンが押しやすいサイズになる
- テキストが読みやすい

#### TC6-2: タブレット表示
**手順:**
1. iPad (768x1024) を選択
2. ヘルプモーダルを開く
3. タブを切り替える

**期待結果:**
- タブが横スクロール可能
- コンテンツが読みやすい

---

### TC7: パフォーマンスとアクセシビリティ

#### TC7-1: キーボード操作
**手順:**
1. 試合中にESCキーを押す

**期待結果:**
- 一時停止メニューが開く

#### TC7-2: アニメーション軽減
**手順:**
1. OSの「視覚効果を減らす」設定を有効にする
2. アプリを開く
3. Toast通知を表示

**期待結果:**
- アニメーションが無効化される
- 即座に表示・非表示される

---

## 不具合チェックリスト

### 表示関連
- [ ] モーダルが正しく中央に表示される
- [ ] オーバーレイの透過度が適切
- [ ] ボタンのホバー効果が動作する
- [ ] テキストが読みやすい

### 機能関連
- [ ] Toastが自動で消える
- [ ] 設定が保存される
- [ ] 自動保存が動作する
- [ ] エラーハンドリングが動作する

### パフォーマンス
- [ ] モーダルの開閉がスムーズ
- [ ] スクロールが滑らか
- [ ] メモリリークがない（長時間プレイ）

---

## 既知の問題

1. **試合再開ダイアログの統合**
   - 現在は手動で表示
   - 起動時の自動表示は未実装

2. **チュートリアルシステム**
   - 設定で有効化できるが、実際のチュートリアルは未実装

3. **多言語対応**
   - 設定に「English」があるが、翻訳は未実装

---

## テスト完了チェック

- [ ] すべてのテストケースが通過
- [ ] モバイル/タブレット/デスクトップで動作確認
- [ ] ダークモード/ライトモードで動作確認
- [ ] エラーがConsoleに出ていない
- [ ] Local Storageが正常に動作
- [ ] パフォーマンスに問題なし
