# 実装タスク

- [ ] 1. 試合開始と基本フローの確立
- [ ] 1.1 試合初期化と開始の画面遷移
  - メインメニューから対戦チーム選択へ遷移できるようにする
  - ホーム/ビジター選択と初期スコアを反映する
  - 試合開始メッセージと先発設定を表示する
  - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 1.2 イニング進行と攻守交代
  - イニング/表裏/攻守の表示を更新する
  - 打順開始とアウト3での交代処理を行う
  - イニング間のスコア更新を反映する
  - _Requirements: 1.6, 1.7, 1.8, 1.9, 1.10_

- [ ] 1.3 試合終了条件と終了演出
  - 9回・延長・コールド・サヨナラの終了条件を判定する
  - 引き分け時の終了と試合時間の表示を行う
  - _Requirements: 1.11, 1.12, 1.13, 1.14, 1.15, 1.16, 1.17, 1.18_

- [ ] 2. 監督指示システムの実装
- [ ] 2.1 攻撃指示メニューと有効条件
  - 打席開始時に基本指示を提示する
  - 走者状況に応じた追加指示を切り替える
  - 無効指示の警告と再提示を行う
  - _Requirements: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, 2.10_

- [ ] 2.2 守備指示メニューと投手/シフト操作
  - 守備ターンで指示メニューを表示する
  - 投手交代時に候補と疲労情報を提示する
  - 敬遠と守備シフトの実行を反映する
  - _Requirements: 2.11, 2.12, 2.13, 2.14, 2.15_

- [ ] 2.3 指示制限とフィードバック
  - 2ストライク/ツーアウト/走力差の警告を表示する
  - 指示実行と結果説明を実況で返す
  - 指示と結果を試合ログへ記録する
  - _Requirements: 2.16, 2.17, 2.18, 2.19, 2.20, 2.21, 2.22, 2.23_

- [ ] 3. 打席判定と確率計算の基礎
- [ ] 3.1 投手対打者の一次判定
  - 乱数を用いた結果選択の骨格を作る
  - 三振/四球/インプレーの判定を能力値で計算する
  - 判定結果に応じて次段階へ遷移する
  - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7, 3.8, 3.9, 3.10, 3.11, 3.12_

- [ ] 3.2 打球種類/方向/強さの決定
  - ゴロ/フライ/ライナーの分布を計算する
  - 利き手と打球傾向で方向分布を調整する
  - 強さ判定と長打補正を適用する
  - _Requirements: 3.13, 3.14, 3.15, 3.16, 3.17, 3.18, 3.19, 3.20, 3.21, 3.22, 3.23, 3.24, 3.25_

- [ ] 3.3 守備判定への接続とヒット種類決定
  - 守備判定へ渡す打球情報を整理する
  - ヒット種類の確定条件を評価する
  - _Requirements: 3.26, 3.27, 3.28, 3.29, 3.30, 3.31, 3.32, 3.33_

- [ ] 3.4 状態補正（疲労/コンディション/左右）
  - 投球数による疲労減衰を計算する
  - 打者コンディションの上下を反映する
  - 左右の組み合わせ補正を適用する
  - _Requirements: 3.34, 3.35, 3.36, 3.37_

- [ ] 4. 守備判定とアウト処理
- [ ] 4.1 打球方向に基づく担当選手の特定
  - 守備位置と補助担当のルールを適用する
  - シフト適用時の処理条件を反映する
  - _Requirements: 3.28, 3.29, 3.30, 3.31, 3.32, 3.33, 3.34, 3.35, 3.36, 3.37, 3.38, 3.39, 3.40, 3.41, 3.42, 3.43, 3.44, 3.45_

- [ ] 4.2 ゴロ/フライ/ライナーの守備処理
  - 守備範囲・エラー・捕球判定を適用する
  - 内野/外野フライの分岐と結果処理を行う
  - ライナー特性の補正を適用する
  - _Requirements: 3.46, 3.47, 3.48, 3.49, 3.50, 3.51, 3.52, 3.53, 3.54, 3.55, 3.56, 3.57, 3.58, 3.59, 3.60, 3.61, 3.62, 3.63, 3.64, 3.65, 3.66, 3.67, 3.68, 3.69, 3.70, 3.71, 3.72, 3.73, 3.74, 3.75, 3.76, 3.77_

- [ ] 4.3 併殺/タッチアップ/送球選択
  - 併殺の2段階判定と失敗時の処理を行う
  - タッチアップの成功率を能力で評価する
  - 複数走者時の送球先選択を決定する
  - _Requirements: 3.78, 3.79, 3.80, 3.81, 3.82, 3.83, 3.84, 3.85, 3.86, 3.87, 3.88, 3.89, 3.90, 3.91, 3.92, 3.93, 3.94, 3.95, 3.96, 3.97, 3.98, 3.99_

- [ ] 4.4 守備エラー詳細と実況
  - エラー種別と進塁影響を判定する
  - 守備選手名を含む実況文を出力する
  - _Requirements: 3.100, 3.101, 3.102, 3.103, 3.104, 3.105_

- [ ] 5. バント/スクイズ判定
- [ ] 5.1 バント打球の方向と処理
  - バント種類ごとの成功率を計算する
  - 打球方向と担当守備選手を決定する
  - 捕球/送球/到達時間を反映する
  - _Requirements: 3.38, 3.39, 3.40, 3.41, 3.42, 3.43, 3.44, 3.45, 3.46, 3.47, 3.48, 3.49, 3.50, 3.51, 3.52, 3.53, 3.54_

- [ ] 5.2 犠打バントと進塁判定
  - 犠打成功時の進塁処理を行う
  - 守備側の狙い判断と封殺成否を評価する
  - _Requirements: 3.55, 3.56, 3.57, 3.58, 3.59, 3.60_

- [ ] 5.3 スクイズの判定
  - 打者/走者能力で成功率を計算する
  - 本塁送球の可否と結果を評価する
  - 成功/失敗時の得点処理を行う
  - _Requirements: 3.61, 3.62, 3.63, 3.64, 3.65, 3.66, 3.67, 3.68_

- [ ] 5.4 バント失敗の処理
  - バント失敗の結果種類を決定する
  - 2ストライク時の三振処理を適用する
  - _Requirements: 3.69, 3.70, 3.71, 3.72_

- [ ] 6. 走塁と進塁判定
- [ ] 6.1 基本進塁ルール
  - 単打/二塁打/三塁打の進塁を確定する
  - 本塁打時の得点処理を行う
  - _Requirements: 3.73, 3.74, 3.75, 3.76, 3.77_

- [ ] 6.2 単打時の本塁到達と追加進塁
  - 外野手送球と走者能力で本塁到達を判定する
  - 追加進塁の試行条件と成功率を評価する
  - _Requirements: 3.78, 3.79, 3.80, 3.81, 3.82, 3.83, 3.84, 3.85, 3.87, 3.88, 3.89, 3.90, 3.91, 3.92, 3.93_

- [ ] 6.3 二塁打時の本塁到達と中継送球
  - 外野捕球位置に応じた判断を行う
  - 中継送球の段階的評価を行う
  - 送球先選択と悪送球時の処理を適用する
  - _Requirements: 3.94, 3.95, 3.96, 3.97, 3.98, 3.99, 3.100, 3.101, 3.102, 3.103, 3.104, 3.105, 3.106, 3.107, 3.108, 3.109, 3.110, 3.111, 3.112, 3.113_

- [ ] 6.4 得点と実況表示
  - 得点加算とスコア更新を行う
  - タイムリーやタッチアウトの実況を表示する
  - _Requirements: 3.114, 3.115, 3.116, 3.117_

- [ ] 7. 盗塁/ダブルスチール/エンドラン/牽制
- [ ] 7.1 盗塁の試行判定
  - 走者・投手・捕手能力で成功率を計算する
  - 塁上守備選手の処理を評価する
  - _Requirements: 3.118, 3.119, 3.120, 3.121, 3.123, 3.124, 3.125, 3.126, 3.127, 3.128, 3.129_

- [ ] 7.2 盗塁結果とダブルスチール
  - 成功/失敗の実況と結果処理を行う
  - ダブルスチールの送球選択と結果を評価する
  - _Requirements: 3.132, 3.133, 3.134, 3.135, 3.136, 3.137, 3.138, 3.139, 3.140, 3.141, 3.142_

- [ ] 7.3 エンドラン判定
  - 打者結果に応じた走塁処理を行う
  - 成功時の実況と進塁増加を適用する
  - _Requirements: 3.143, 3.144, 3.145, 3.146, 3.147, 3.148, 3.149_

- [ ] 7.4 牽制プレイ判定
  - 牽制試行確率とリード幅評価を行う
  - 牽制成功/悪送球の処理を適用する
  - _Requirements: 3.150, 3.151, 3.152, 3.154, 3.155, 3.156_

- [ ] 8. 選手能力システムとチーム運用
- [ ] 8.1 能力値モデルと分類ロジック
  - 打撃/投球/走塁/守備の能力値を保持する
  - 打者/投手タイプ分類と左右補正を適用する
  - 能力値の影響範囲をゲーム判定に反映する
  - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 4.10, 4.11, 4.12, 4.13, 4.14, 4.15, 4.16, 4.17, 4.18, 4.19, 4.20, 4.21, 4.22, 4.23, 4.24, 4.25, 4.26, 4.27, 4.28, 4.29, 4.30, 4.31, 4.32, 4.33, 4.34, 4.35, 4.36, 4.37, 4.38, 4.39, 4.40_

- [ ] 8.2 コンディションと疲労の影響
  - コンディション段階による能力補正を行う
  - 疲労度の管理と能力減衰を適用する
  - _Requirements: 4.41, 4.42, 4.43, 4.44, 4.45, 4.59, 4.60, 4.61, 4.62, 4.63, 4.64, 4.65, 4.66, 4.67_

- [ ] 8.3 打順・ロースター運用
  - 先発/ベンチ構成と打順編集を提供する
  - 推奨打順の自動生成を行う
  - _Requirements: 4.46, 4.47, 4.48, 4.49, 4.50, 4.51, 4.52_

- [ ] 8.4 試合中の選手表示
  - 打者/投手の主要能力と成績を表示する
  - 左右の組み合わせ表示と投球数表示を行う
  - _Requirements: 4.53, 4.54, 4.55, 4.56, 4.57, 4.58_

- [ ] 8.5 交代ルールの適用
  - 代打/守備固めの選択と反映を行う
  - 再出場不可とDHルールを適用する
  - _Requirements: 4.68, 4.69, 4.70, 4.71, 4.72, 4.73, 4.74, 4.75_

- [ ] 8.6 能力値の可視化と総合評価
  - 能力値の色分け表示を行う
  - 総合評価の自動計算を実装する
  - 試合中成績の更新と保存を行う
  - _Requirements: 4.76, 4.77, 4.78, 4.79, 4.80, 4.81, 4.82, 4.83, 4.84, 4.85_

- [ ] 9. 試合状況の可視化
- [ ] 9.1 スコアボードとイニング表示
  - 得点/イニング/アウト/カウントを常時表示する
  - イニング別得点表と打順位置を表示する
  - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 9.2 塁上ランナー表示
  - 塁状況の可視化と選手名表示を行う
  - 進塁/得点時に視覚的更新を行う
  - _Requirements: 5.6, 5.7, 5.8, 5.9, 5.10_

- [ ] 9.3 実況とプレイ結果表示
  - 打席の流れと結果を実況表示する
  - 重要プレイを強調表示する
  - _Requirements: 5.11, 5.12, 5.13, 5.14, 5.15_

- [ ] 9.4 重要局面とガイダンス表示
  - 得点圏/接戦/サヨナラ機会のラベルを表示する
  - 次の操作を示すガイドを常時表示する
  - _Requirements: 5.16, 5.17, 5.18, 5.19, 5.20, 5.30_

- [ ] 9.5 プレイログと履歴表示 (P)
  - プレイ履歴を時系列で保存し表示する
  - イニング単位のフィルタを提供する
  - ログ件数制限と圧縮を適用する
  - _Requirements: 5.21, 5.22, 5.23, 5.24, 5.25_

- [ ] 9.6 UIレイアウトと情報整理
  - レスポンシブレイアウトを適用する
  - 情報量過多時の折りたたみ/モーダルを提供する
  - _Requirements: 5.26, 5.27, 5.28, 5.29_

- [ ] 10. 勝敗判定と試合終了処理
- [ ] 10.1 通常終了時の勝敗判定
  - 9回終了条件と勝敗表示を行う
  - 最終スコアと成績サマリーを表示する
  - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_

- [ ] 10.2 延長/サヨナラ/コールドの判定
  - 延長開始と回数表示を行う
  - サヨナラ条件と即時終了を適用する
  - コールド/ノーゲームの扱いを反映する
  - _Requirements: 6.6, 6.7, 6.8, 6.9, 6.10, 6.11, 6.12, 6.13, 6.14, 6.15, 6.16, 6.17_

- [ ] 10.3 試合終了後の保存と次アクション
  - 試合結果を保存し次の選択肢を提示する
  - MVP/ハイライト表示オプションを提供する
  - 集計値と個人成績を確定する
  - _Requirements: 6.18, 6.19, 6.20, 6.21, 6.22, 6.23, 6.24, 6.25_

- [ ] 11. エラーハンドリングとユーザビリティ
- [ ] 11.1 入力エラー対応
  - 無効指示の理由を説明し再選択させる
  - エラー時に状態を維持し視覚的警告を表示する
  - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5_

- [ ] 11.2 システムエラーと自動保存
  - 例外時の緊急保存とエラーログを記録する
  - 再起動時の復旧確認ダイアログを表示する
  - _Requirements: 7.6, 7.7, 7.8, 7.9, 7.10_

- [ ] 11.3 中断/再開フロー
  - 一時停止メニューと保存/終了を提供する
  - 再開時に試合状態を復元する
  - _Requirements: 7.11, 7.12, 7.13, 7.14, 7.15_

- [ ] 11.4 操作ガイドとヘルプ
  - 指示オプションの説明を付与する
  - チュートリアル/ヘルプをモーダルで表示する
  - _Requirements: 7.16, 7.17, 7.18, 7.19, 7.20_

- [ ] 11.5 レスポンスと表示テンポ
  - 操作受付の即時反映と応答時間を維持する
  - テキスト速度と続行ボタンを制御する
  - _Requirements: 7.21, 7.22, 7.23, 7.24, 7.25_

- [ ] 11.6 アクセシビリティとカスタマイズ
  - 表示言語/テーマ/難易度の設定を提供する
  - 設定を保存して次回起動に反映する
  - _Requirements: 7.26, 7.27, 7.28, 7.29, 7.30_

- [ ] 12. 試合履歴と戦績管理
- [ ] 12.1 試合結果の保存 (P)
  - 試合結果とハイライトを永続化する
  - 保存完了メッセージを表示する
  - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5_

- [ ] 12.2 履歴一覧の表示 (P)
  - 履歴一覧を新しい順に表示する
  - ページネーション/スクロールを提供する
  - _Requirements: 8.6, 8.7, 8.8, 8.9, 8.10_

- [ ] 12.3 履歴詳細とログ (P)
  - 試合詳細画面を表示する
  - プレイ履歴の詳細ログを表示する
  - _Requirements: 8.11, 8.12, 8.13, 8.14, 8.15_

- [ ] 12.4 通算成績の集計 (P)
  - 勝率や自己ベストを計算して表示する
  - 戦績サマリーを見やすく表示する
  - _Requirements: 8.16, 8.17, 8.18, 8.19, 8.20_

- [ ] 12.5 フィルタと検索 (P)
  - 期間/勝敗/対戦相手のフィルタを実装する
  - フィルタ後の再集計を反映する
  - _Requirements: 8.21, 8.22, 8.23, 8.24, 8.25_

- [ ] 12.6 データ永続化と復元
  - 起動時に履歴データを復元する
  - 破損時のエラーメッセージと初期化を行う
  - _Requirements: 8.26, 8.27, 8.28, 8.29, 8.30_

- [ ] 12.7 履歴削除と圧縮
  - 削除前の確認と警告を表示する
  - 古いログの圧縮オプションを提供する
  - _Requirements: 8.31, 8.32, 8.33, 8.34, 8.35_

- [ ] 12.8 トレンド分析とグラフ
  - 最近の成績と得失点を集計表示する
  - グラフ/ランキングを表示する
  - _Requirements: 8.36, 8.37, 8.38, 8.39, 8.40_

- [ ] 13. 選手・チームデータ管理
- [ ] 13.1 デフォルト選手データのロード
  - 初回起動時のデータロードと検証を行う
  - エラー時の詳細表示とスキップ処理を行う
  - _Requirements: 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7, 9.8, 9.9, 9.10_

- [ ] 13.2 選手詳細表示 (P)
  - 能力値一覧と色分け表示を行う
  - 詳細画面の操作ボタンを提供する
  - _Requirements: 9.11, 9.12, 9.13, 9.14, 9.15_

- [ ] 13.3 選手の新規作成 (P)
  - 作成フォームと必須項目入力を提供する
  - 能力値変更時に総合評価を更新する
  - 保存時の検証と確認メッセージを表示する
  - _Requirements: 9.16, 9.17, 9.18, 9.19, 9.20, 9.21, 9.22, 9.23, 9.24_

- [ ] 13.4 選手の編集
  - 既存データを入力済みで表示する
  - 変更差分と確認ダイアログを表示する
  - _Requirements: 9.25, 9.26, 9.27, 9.28, 9.29, 9.30_

- [ ] 13.5 選手の削除
  - 削除確認と追加警告を表示する
  - 削除後の一覧復帰を行う
  - _Requirements: 9.31, 9.32, 9.33, 9.34_

- [ ] 13.6 チーム管理とロースター編集 (P)
  - チーム作成/編集のフォームを提供する
  - ロースター最小人数の検証を行う
  - _Requirements: 9.35, 9.36, 9.37, 9.38, 9.39, 9.40_

- [ ] 13.7 データのインポート/エクスポート
  - エクスポート対象の選択と保存を行う
  - インポートの検証と重複処理を行う
  - _Requirements: 9.41, 9.42, 9.43, 9.44, 9.45, 9.46, 9.47, 9.48, 9.49, 9.50_

- [ ] 13.8 テンプレートとバッチ編集
  - プリセット適用とテンプレート保存を提供する
  - バッチ編集の確認と結果表示を行う
  - _Requirements: 9.51, 9.52, 9.53, 9.54, 9.55, 9.56, 9.57, 9.58, 9.59, 9.60_

- [ ] 13.9 バックアップと整合性チェック
  - 自動バックアップと世代管理を行う
  - 破損検出時の復元処理を提供する
  - _Requirements: 9.61, 9.62, 9.63, 9.64, 9.65, 9.66, 9.67, 9.68_

- [ ] 13.10 ヘルプとサンプル提供
  - 能力値ガイドと操作ヘルプを表示する
  - サンプルデータの参照導線を提供する
  - _Requirements: 9.69, 9.70, 9.71, 9.72_

- [ ] 14. CPU戦術AIの実装
- [ ] 14.1 基本AI判断と難易度
  - 攻守ターンに応じた判断フローを作る
  - 思考時間の演出と難易度補正を反映する
  - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5_

- [ ] 14.2 攻撃戦術の判断
  - 通常打撃/バント/盗塁/エンドラン/スクイズを選択する
  - 点差やカウントに応じた確率補正を適用する
  - _Requirements: 10.6, 10.7, 10.8, 10.9, 10.10, 10.11, 10.12, 10.13, 10.14, 10.15, 10.16, 10.17, 10.18, 10.19, 10.20, 10.21, 10.22, 10.23, 10.24, 10.25, 10.26, 10.27, 10.28, 10.29, 10.30, 10.31, 10.32, 10.33, 10.34_

- [ ] 14.3 守備戦術の判断
  - 投手交代の確率判断を行う
  - 敬遠と守備シフトの選択を決定する
  - _Requirements: 10.35, 10.36, 10.37, 10.38, 10.39, 10.40, 10.41, 10.42, 10.43, 10.44, 10.45, 10.46, 10.47, 10.48, 10.49, 10.50_

- [ ] 15. 守備シフトシステム
- [ ] 15.1 シフト種別と選択条件
  - シフト種別と基本補正を定義する
  - 推奨表示と変更制約を適用する
  - _Requirements: 11.1, 11.2, 11.3, 11.4, 11.5, 11.6, 11.7, 11.8, 11.9, 11.10, 11.11, 11.12, 11.13, 11.14, 11.15_

- [ ] 15.2 ゴロ打球への効果
  - シフト方向に応じた補正を計算する
  - 前進守備の本塁阻止補正を適用する
  - _Requirements: 11.16, 11.17, 11.18, 11.19, 11.20, 11.21, 11.22_

- [ ] 15.3 フライ/ライナー/長打への効果
  - 深守備/前進守備の補正を適用する
  - 逆方向打球と長打への影響を反映する
  - 特殊状況の補正を適用する
  - _Requirements: 11.24, 11.25, 11.26, 11.27, 11.29, 11.30, 11.31, 11.32, 11.33, 11.34, 11.35, 11.36, 11.37, 11.38, 11.39, 11.40_

- [ ] 15.4 シフトの演出と統計
  - シフト指示と結果を実況に反映する
  - 使用回数/成功率の統計を記録する
  - _Requirements: 11.41, 11.42, 11.43, 11.44, 11.45, 11.46, 11.47, 11.48, 11.49, 11.50, 11.51, 11.52_

- [ ] 15.5 CPUシフトと戦術調整
  - CPUのシフト選択確率を難易度で調整する
  - 試合状況に応じた戦術調整と交代判断を適用する
  - AI判断の演出とログ出力を行う
  - _Requirements: 11.53, 11.54, 11.55, 11.56, 11.57, 11.58, 11.59, 11.60, 11.61, 11.62, 11.63, 11.64, 11.65, 11.66, 11.67, 11.68, 11.69, 11.70, 11.71, 11.72_

- [ ] 15.6 AI委譲機能
  - AI委譲の選択肢と実行フローを用意する
  - 確認モード/常時委譲/難易度を設定できるようにする
  - ハイライト表示や手動復帰を提供する
  - _Requirements: 11.73, 11.74, 11.75, 11.76, 11.77, 11.78, 11.79, 11.80, 11.81, 11.82, 11.83, 11.84, 11.85, 11.86, 11.87, 11.88, 11.89, 11.90, 11.91, 11.92, 11.93, 11.94, 11.95, 11.96, 11.97, 11.98_

- [ ] 15.7 AI推奨表示と学習拡張
  - 一定時間無操作時のAI推奨を表示する
  - 推奨理由の表示と設定切替を提供する
  - 将来拡張の学習/適応フックを設ける
  - _Requirements: 11.99, 11.100, 11.101, 11.102, 11.103, 11.104, 11.105, 11.106_
